var ParameterSweepSimulationsPainter = {
    
    paramSweepSimulations: null,
    
    init: function(){
    },
    
    paint: function(){
        this.getParameterSweepSimulations();
    },
    
    paintParameterSweepSimulationsTable: function(){
        var table_body = $("#paramSweepSimulationsTable > tbody");
        table_body.empty();
        for (var i = 0; i < this.paramSweepSimulations.length; i++){
            var table_tr = $("<tr></tr>");
            var td_name = $('<td>' + this.paramSweepSimulations[i].name + '</td>');
            var td_num_rep = $("<td>" + this.paramSweepSimulations[i].numRepetitions + "</td>");
            var td_param_cd = $("<td>" + this.paramSweepSimulations[i].creationDate + "</td>");
            var td_param_ud = $("<td>" + this.paramSweepSimulations[i].updateDate + "</td>");
            var param_status_html = '<td class="status">';
            switch(this.paramSweepSimulations[i].status){
                case "WAITING": param_status_html += '<span class="glyphicon glyphicon-time" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Esperando"></span>' +
                                                   '<span class="sr-only">Esperando</span>';
                                break;
                case "PROCESSING": param_status_html += '<span class="glyphicon glyphicon-flash" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Procesando"></span>' +
                                                      '<span class="sr-only"Procesando</span>';
                                   break;
                                                  
                case "ERROR": param_status_html += '<span class="glyphicon glyphicon-warning-sign" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Error"></span>' +
                                                 '<span class="sr-only"Error</span>';
                              break;
                case "FINISHED": param_status_html += '<span class="glyphicon glyphicon-ok" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Terminado"></span>' +
                                                    '<span class="sr-only"Terminado</span>';
                                 break;
                    
            }
            param_status_html += "</td>";
            var td_param_status = $(param_status_html);
            var actions_html = '<td class="actions"><div class="btn-group actions-group">' +
                               '<button class="btn btn-default btn-sm" ><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Ver detalles</button>' +
                               '<button data-toggle="dropdown" class="btn btn-default btn-sm dropdown-toggle"><span class="caret"></span></button>' +
                               '<ul class="dropdown-menu">' +
                                    '<li><a href="#" onclick="EditProjectModal.editProject(' + this.paramSweepSimulations[i].simulationId + ')"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span> Editar simulación</a></li>';
            switch(this.paramSweepSimulations[i].status){
                case "WAITING": actions_html+= '<li><a href="#" onclick="ParameterSweepSimulationController.startSimulation(' + this.paramSweepSimulations[i].simulationId + ')"><span class="glyphicon glyphicon-play" aria-hidden="true"></span> Ejecutar simulación</a></li>';
                                break;
                case "PROCESSING": actions_html+= '<li><a href="#" onclick="ParameterSweepSimulationController.stopSimulation(' + this.paramSweepSimulations[i].simulationId + ')"><span class="glyphicon glyphicon-stop" aria-hidden="true"></span> Detener simulación</a></li>';
                                   break;
                case "FINISHED": actions_html+= '<li><a href="#" onclick="SimulationManager.showResults(' + this.paramSweepSimulations[i].simulationId + ')"><span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span> Ver resultados</a></li>';
                                 break;
            }
            actions_html+= '<li><a href="#" onclick="DeleteSimulationModal.deleteSimulation(' + this.paramSweepSimulations[i].simulationId + ',\'single\')"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span> Eliminar simulación</a></li>' +
                           '</ul>' +
                           '</div></td>';
           var td_actions = $(actions_html);
           table_tr.append(td_name);
           table_tr.append(td_num_rep);
           table_tr.append(td_param_cd);
           table_tr.append(td_param_ud);
           table_tr.append(td_param_status);
           table_tr.append(td_actions);
           table_body.append(table_tr);
        }
        $('[data-toggle="tooltip"]').tooltip();
    },
    
    getParameterSweepSimulations: function(){
        $.ajax({
            url: getBaseApiUrl() + "/users/username/projects/" + G_VARS["projectId"] + "/parametersweepsimulations/",
            method: "GET",
            dataType: "json",//the expected data type from the server
            success : function(data) {
                ParameterSweepSimulationsPainter.paramSweepSimulations = data;
                ParameterSweepSimulationsPainter.paintParameterSweepSimulationsTable();
            },
            error : function(xhr, status) {
                alert(status);
            },
 
            // código a ejecutar sin importar si la petición falló o no
            complete : function(xhr, status) {
                //alert(status);
            }
        });
    }
};


